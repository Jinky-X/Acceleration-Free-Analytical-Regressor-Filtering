function [v,u] = vec_spatial(q,dq)
q1=q(1);q2=q(2);q3=q(3);q4=q(4);q5=q(5);q6=q(6);q7=q(7);
dq1=dq(1);dq2=dq(2);dq3=dq(3);dq4=dq(4);dq5=dq(5);dq6=dq(6);dq7=dq(7);
% ddq1=ddq(1);ddq2=ddq(2);ddq3=ddq(3);ddq4=ddq(4);ddq5=ddq(5);ddq6=ddq(6);ddq7=ddq(7);

u=zeros(6,7);%du=zeros(6,7);


u(1,2)=-dq1*sin(q2);
u(1,3)=dq2*sin(q3) - dq1*cos(q3)*sin(q2);
u(1,4)=sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2));
u(1,5)=sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)));
u(1,6)=cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)));
u(1,7)=sin(q7)*(dq6 - cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + cos(q7)*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))));
u(2,2)=-dq1*cos(q2);
u(2,3)=dq2*cos(q3) + dq1*sin(q2)*sin(q3);
u(2,4)=cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2));
u(2,5)=cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)));
u(2,6)=cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))));
u(2,7)=cos(q7)*(dq6 - cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - sin(q7)*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))));
u(3,1)=dq1;
u(3,2)=dq2;
u(3,3)=dq3 + dq1*cos(q2);
u(3,4)=dq4 - dq2*cos(q3) - dq1*sin(q2)*sin(q3);
u(3,5)=dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2));
u(3,6)=dq6 - cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)));
u(3,7)=dq7 + sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)));
u(4,3)=(79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250;
u(4,4)=cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400;
u(4,5)=cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400;
u(4,6)=cos(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) - sin(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400);
u(4,7)=(11*sin(q7)*(sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))))/125 + sin(q7)*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) - cos(q7)*(sin(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400) - cos(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400));
u(5,3)=(79*dq1*cos(q3)*sin(q2))/250 - (79*dq2*sin(q3))/250;
u(5,4)=- (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 - sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250);
u(5,5)=cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) - sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400;
u(5,6)=- sin(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) - cos(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400);
u(5,7)=cos(q7)*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + sin(q7)*(sin(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400) - cos(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400)) + (11*cos(q7)*(sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))))/125;
u(6,4)=(79*dq2*sin(q3))/250 - (33*dq1*cos(q2))/400 - (33*dq3)/400 - (79*dq1*cos(q3)*sin(q2))/250;
u(6,5)=(33*dq2*cos(q3))/400 - (33*dq4)/400 - (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 - sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*dq1*sin(q2)*sin(q3))/400;
u(6,6)=sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400;
u(6,7)=sin(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) - (11*dq6)/125 + (11*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (11*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + cos(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400);

v=u;


% du(1,2)=- ddq1*sin(q2) - dq1*dq2*cos(q2);
% du(1,3)=dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3);
% du(1,4)=dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3));
% du(1,5)=cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))));
% du(1,6)=cos(q6)*(cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))) - dq6*(sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3)));
% du(1,7)=sin(q7)*(ddq6 + cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) + dq5*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))) - dq7*(sin(q7)*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q7)*(dq6 - cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))) + cos(q7)*(cos(q6)*(cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))) - dq6*(sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))));
% du(2,2)=dq1*dq2*sin(q2) - ddq1*cos(q2);
% du(2,3)=sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3);
% du(2,4)=cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3));
% du(2,5)=- cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) - sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - dq5*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))));
% du(2,6)=cos(q6)*(ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - dq6*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - sin(q6)*(cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))));
% du(2,7)=cos(q7)*(ddq6 + cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) + dq5*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))) - dq7*(sin(q7)*(dq6 - cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + cos(q7)*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))) - sin(q7)*(cos(q6)*(cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))) - dq6*(sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))));
% du(3,1)=ddq1;
% du(3,2)=ddq2;
% du(3,3)=ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2);
% du(3,4)=ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3);
% du(3,5)=ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3));
% du(3,6)=ddq6 + cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) + dq5*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))));
% du(3,7)=ddq7 + dq6*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) + sin(q6)*(cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))));
% du(4,2)=-(981*sin(q2))/100;
% du(4,3)=(79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - (981*cos(q3)*sin(q2))/100 - dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) + (79*ddq2*cos(q3))/250;
% du(4,4)=(981*cos(q2)*sin(q4))/100 - dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 - cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250);
% du(4,5)=sin(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) - (48*cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 + (33*sin(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 - (48*sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 - dq5*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) - cos(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250));
% du(4,6)=- dq6*(sin(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400)) - cos(q6)*((48*cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 - sin(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) - (33*sin(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 + (48*sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 + dq5*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 ...
%     + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250))) - sin(q6)*((33*ddq4)/400 - (981*cos(q2)*cos(q4))/100 - (33*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/400 + (33*dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))/400 - (33*ddq2*cos(q3))/400 + dq4*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + (33*cos(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 - sin(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250));
% du(4,7)=dq7*(cos(q7)*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + sin(q7)*(sin(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400) - cos(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400)) + (11*cos(q7)*(sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))))/125) - cos(q7)*(dq6*(sin(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q6)*((33*dq4)/400 - ...
%     (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400)) + cos(q6)*((48*cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 - sin(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) - (33*sin(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 + (48*sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 + dq5*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - ...
%     (79*ddq2*cos(q3))/250))) + sin(q6)*((33*ddq4)/400 - (981*cos(q2)*cos(q4))/100 - (33*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/400 + (33*dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))/400 - (33*ddq2*cos(q3))/400 + dq4*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + (33*cos(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 - sin(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250))) - sin(q7)*((48*sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 + cos(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) + (33*cos(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 - (48*cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 - dq5*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - ...
%     dq1*cos(q3)*sin(q2))))/400) + sin(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250))) + (11*sin(q7)*(dq6*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) + sin(q6)*(cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))))))/125;
% du(5,2)=-(981*cos(q2))/100;
% du(5,3)=(981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (79*ddq2*sin(q3))/250;
% du(5,4)=(981*cos(q2)*cos(q4))/100 - dq4*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - (33*cos(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + sin(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250);
% du(5,5)=(48*sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 + cos(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) + (33*cos(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 - (48*cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 - dq5*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + sin(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250));
% du(5,6)=dq6*(sin(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400) - cos(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400)) - cos(q6)*((33*ddq4)/400 - (981*cos(q2)*cos(q4))/100 - (33*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/400 + (33*dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))/400 - (33*ddq2*cos(q3))/400 + dq4*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + (33*cos(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 - sin(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250)) + sin(q6)*((48*cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 - sin(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) - (33*sin(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 + (48*sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - ...
%     sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 + dq5*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250)));
% du(5,7)=sin(q7)*(dq6*(sin(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400)) + cos(q6)*((48*cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 - sin(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) - (33*sin(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 + (48*sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 + dq5*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - ...
%     dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250))) + sin(q6)*((33*ddq4)/400 - (981*cos(q2)*cos(q4))/100 - (33*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/400 + (33*dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))/400 - (33*ddq2*cos(q3))/400 + dq4*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + (33*cos(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 - sin(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250))) - dq7*((11*sin(q7)*(sin(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))))/125 + sin(q7)*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) - cos(q7)*(sin(q6)*((33*dq4)/400 - ...
%     (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400) - cos(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400))) - cos(q7)*((48*sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 + cos(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) + (33*cos(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 - (48*cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 - dq5*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - ...
%     (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + sin(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250))) + (11*cos(q7)*(dq6*(cos(q6)*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) + sin(q6)*(dq5 + cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))) - cos(q6)*(ddq5 - dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) - sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) + sin(q6)*(cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))) - sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)) + dq5*(cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) - sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))))))/125;
% du(6,1)=981/100;
% du(6,3)=(981*cos(q2))/100;
% du(6,4)=dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (981*sin(q2)*sin(q3))/100 - (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - (33*ddq3)/400 - (33*ddq1*cos(q2))/400 + (79*ddq2*sin(q3))/250 + (33*dq1*dq2*sin(q2))/400;
% du(6,5)=(981*cos(q2)*cos(q4))/100 - (33*ddq4)/400 + (33*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/400 - (33*dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))/400 + (33*ddq2*cos(q3))/400 - dq4*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - (33*cos(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + sin(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250);
% du(6,6)=(48*cos(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 - cos(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) - (33*cos(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 - (48*sin(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 + dq5*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) - sin(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250));
% du(6,7)=cos(q6)*((33*ddq4)/400 - (981*cos(q2)*cos(q4))/100 - (33*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/400 + (33*dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))/400 - (33*ddq2*cos(q3))/400 + dq4*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + (33*cos(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 - sin(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250)) - (11*cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 - dq6*(sin(q6)*((33*dq4)/400 - (33*dq2*cos(q3))/400 + (33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*dq1*sin(q2)*sin(q3))/400) - cos(q6)*(cos(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) + sin(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*cos(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 - (48*sin(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 - (33*sin(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400)) - (11*sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 - (11*dq5*(sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)) + cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)))))/125 - (11*ddq6)/125 - sin(q6)*((48*cos(q5)*(ddq4 - sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + dq3*(dq2*sin(q3) - ...
%     dq1*cos(q3)*sin(q2)) - ddq2*cos(q3)))/125 - sin(q5)*((33*ddq3)/400 + (981*sin(q2)*sin(q3))/100 + (79*cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 - dq3*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) + (33*ddq1*cos(q2))/400 - (79*ddq2*sin(q3))/250 - (33*dq1*dq2*sin(q2))/400) - (33*sin(q5)*(dq4*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) - cos(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + sin(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/400 + (48*sin(q5)*(dq4*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))) + sin(q4)*(ddq3 + ddq1*cos(q2) - dq1*dq2*sin(q2)) + cos(q4)*(dq3*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)) - cos(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) + ddq2*sin(q3))))/125 + dq5*(sin(q5)*(cos(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250) - (33*sin(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400) - cos(q5)*((33*dq3)/400 + (33*dq1*cos(q2))/400 - (79*dq2*sin(q3))/250 + (79*dq1*cos(q3)*sin(q2))/250) + (48*sin(q5)*(dq2*cos(q3) - dq4 + dq1*sin(q2)*sin(q3)))/125 + (48*cos(q5)*(sin(q4)*(dq3 + dq1*cos(q2)) + cos(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/125 + (33*cos(q5)*(cos(q4)*(dq3 + dq1*cos(q2)) - sin(q4)*(dq2*sin(q3) - dq1*cos(q3)*sin(q2))))/400) + cos(q5)*(dq4*((33*cos(q4)*(dq2*cos(q3) + dq1*sin(q2)*sin(q3)))/400 + sin(q4)*((79*dq2*cos(q3))/250 + (79*dq1*sin(q2)*sin(q3))/250)) - (981*cos(q2)*sin(q4))/100 + (33*sin(q4)*(sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)) - dq3*(dq2*sin(q3) - dq1*cos(q3)*sin(q2)) + ddq2*cos(q3)))/400 + cos(q4)*((981*cos(q3)*sin(q2))/100 - (79*sin(q3)*(ddq1*sin(q2) + dq1*dq2*cos(q2)))/250 + dq3*((79*dq2*sin(q3))/250 - (79*dq1*cos(q3)*sin(q2))/250) - (79*ddq2*cos(q3))/250)));
% 

