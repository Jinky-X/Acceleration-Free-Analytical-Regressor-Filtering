function XXnSI=matrix_XXnSI(sin_q,cos_q)
%% Corresponding to 
%% [s_1^T], [s_1^T[X_2^1]^*;s_2^T], ..., [s_1^T[X_n^1]^*;s_2^T[X_n^2]^*,...,s_n^T] in the formuation (19)


% q1=q(1);q2=q(2);q3=q(3);q4=q(4);q5=q(5);q6=q(6);q7=q(7);
% s1=sin(q1);c1=cos(q1);
% s2=sin(q2);c2=cos(q2);s3=sin(q3);c3=cos(q3);
% s4=sin(q4);c4=cos(q4);s5=sin(q5);c5=cos(q5);s6=sin(q6);c6=cos(q6);
% s7=sin(q7);c7=cos(q7);

s1=sin_q(1);s2=sin_q(2);s3=sin_q(3);s4=sin_q(4);s5=sin_q(5);s6=sin_q(6);s7=sin_q(7);
c1=cos_q(1);c2=cos_q(2);c3=cos_q(3);c4=cos_q(4);c5=cos_q(5);c6=cos_q(6);c7=cos_q(7);

% XXnSI=sym(zeros(7,42));
XXnSI=zeros(7,42);
XXnSI(1,3)=1;
XXnSI(1,7)=-s2;
XXnSI(1,8)=-c2;
XXnSI(1,13)=-c3*s2;
XXnSI(1,14)=s2*s3;
XXnSI(1,15)=c2;
XXnSI(1,16)=(79*s2*s3)/250;
XXnSI(1,17)=(79*c3*s2)/250;
XXnSI(1,19)=c2*s4 - c3*c4*s2;
XXnSI(1,20)=c2*c4 + c3*s2*s4;
XXnSI(1,21)=-s2*s3;
XXnSI(1,22)=(s2*s3*(632*c4 - 165*s4))/2000;
XXnSI(1,23)=-(s2*s3*(165*c4 + 632*s4))/2000;
XXnSI(1,24)=- (33*c2)/400 - (79*c3*s2)/250;
XXnSI(1,25)=s2*s3*s5 + c2*c5*s4 - c3*c4*c5*s2;
XXnSI(1,26)=c5*s2*s3 - c2*s4*s5 + c3*c4*s2*s5;
XXnSI(1,27)=c2*c4 + c3*s2*s4;
XXnSI(1,28)=(33*c2*s5)/400 - (33*c2*c4*s5)/400 + (79*c3*s2*s5)/250 + (48*c5*s2*s3)/125 - (48*c2*s4*s5)/125 + (48*c3*c4*s2*s5)/125 + (79*c4*c5*s2*s3)/250 - (33*c3*s2*s4*s5)/400 - (33*c5*s2*s3*s4)/400;
XXnSI(1,29)=(33*c2*c5)/400 - (48*s2*s3*s5)/125 - (33*c2*c4*c5)/400 + (79*c3*c5*s2)/250 - (48*c2*c5*s4)/125 + (48*c3*c4*c5*s2)/125 - (33*c3*c5*s2*s4)/400 - (79*c4*s2*s3*s5)/250 + (33*s2*s3*s4*s5)/400;
XXnSI(1,30)=-(s2*s3*(165*c4 + 632*s4 - 165))/2000;
XXnSI(1,31)=c2*c4*s6 + c2*c5*c6*s4 + c3*s2*s4*s6 + c6*s2*s3*s5 - c3*c4*c5*c6*s2;
XXnSI(1,32)=c2*c4*c6 + c3*c6*s2*s4 - c2*c5*s4*s6 - s2*s3*s5*s6 + c3*c4*c5*s2*s6;
XXnSI(1,33)=c2*s4*s5 - c5*s2*s3 - c3*c4*s2*s5;
XXnSI(1,34)=(33*s2*s3*s6)/400 + (33*c2*c6*s5)/400 - (33*c2*c4*c6*s5)/400 + (79*c3*c6*s2*s5)/250 + (48*c5*c6*s2*s3)/125 - (48*c2*c6*s4*s5)/125 - (33*c4*s2*s3*s6)/400 - (79*s2*s3*s4*s6)/250 + (48*c3*c4*c6*s2*s5)/125 + (79*c4*c5*c6*s2*s3)/250 - (33*c3*c6*s2*s4*s5)/400 - (33*c5*c6*s2*s3*s4)/400;
XXnSI(1,35)=(33*c6*s2*s3)/400 - (33*c2*s5*s6)/400 - (33*c4*c6*s2*s3)/400 + (33*c2*c4*s5*s6)/400 - (79*c6*s2*s3*s4)/250 - (79*c3*s2*s5*s6)/250 - (48*c5*s2*s3*s6)/125 + (48*c2*s4*s5*s6)/125 - (48*c3*c4*s2*s5*s6)/125 - (79*c4*c5*s2*s3*s6)/250 + (33*c3*s2*s4*s5*s6)/400 + (33*c5*s2*s3*s4*s6)/400;
XXnSI(1,36)=(48*s2*s3*s5)/125 - (33*c2*c5)/400 + (33*c2*c4*c5)/400 - (79*c3*c5*s2)/250 + (48*c2*c5*s4)/125 - (48*c3*c4*c5*s2)/125 + (33*c3*c5*s2*s4)/400 + (79*c4*s2*s3*s5)/250 - (33*s2*s3*s4*s5)/400;
XXnSI(1,37)=c2*c4*c7*s6 - c5*s2*s3*s7 + c2*s4*s5*s7 + c2*c5*c6*c7*s4 - c3*c4*s2*s5*s7 + c3*c7*s2*s4*s6 + c6*c7*s2*s3*s5 - c3*c4*c5*c6*c7*s2;
XXnSI(1,38)=c2*c7*s4*s5 - c5*c7*s2*s3 - c2*c4*s6*s7 - c3*c4*c7*s2*s5 - c2*c5*c6*s4*s7 - c3*s2*s4*s6*s7 - c6*s2*s3*s5*s7 + c3*c4*c5*c6*s2*s7;
XXnSI(1,39)=c2*c5*s4*s6 - c3*c6*s2*s4 - c2*c4*c6 + s2*s3*s5*s6 - c3*c4*c5*s2*s6;
XXnSI(1,40)=(33*c2*c4*c5*s7)/400 - (33*c2*c5*s7)/400 - (11*c2*c4*c6*s7)/125 + (33*c2*c6*c7*s5)/400 - (79*c3*c5*s2*s7)/250 + (48*c2*c5*s4*s7)/125 + (33*c7*s2*s3*s6)/400 + (48*s2*s3*s5*s7)/125 - (33*c2*c4*c6*c7*s5)/400 - (48*c3*c4*c5*s2*s7)/125 + (79*c3*c6*c7*s2*s5)/250 + (48*c5*c6*c7*s2*s3)/125 - (48*c2*c6*c7*s4*s5)/125 + (33*c3*c5*s2*s4*s7)/400 - (11*c3*c6*s2*s4*s7)/125 - (33*c4*c7*s2*s3*s6)/400 + (11*c2*c5*s4*s6*s7)/125 + (79*c4*s2*s3*s5*s7)/250 - (79*c7*s2*s3*s4*s6)/250 - (33*s2*s3*s4*s5*s7)/400 + (11*s2*s3*s5*s6*s7)/125 + (48*c3*c4*c6*c7*s2*s5)/125 + (79*c4*c5*c6*c7*s2*s3)/250 - (11*c3*c4*c5*s2*s6*s7)/125 - (33*c3*c6*c7*s2*s4*s5)/400 - (33*c5*c6*c7*s2*s3*s4)/400;
XXnSI(1,41)=(33*c2*c4*c5*c7)/400 - (33*c2*c5*c7)/400 - (11*c2*c4*c6*c7)/125 - (79*c3*c5*c7*s2)/250 + (48*c2*c5*c7*s4)/125 - (33*c2*c6*s5*s7)/400 + (48*c7*s2*s3*s5)/125 - (33*s2*s3*s6*s7)/400 - (48*c3*c4*c5*c7*s2)/125 + (33*c3*c5*c7*s2*s4)/400 - (11*c3*c6*c7*s2*s4)/125 + (33*c2*c4*c6*s5*s7)/400 + (11*c2*c5*c7*s4*s6)/125 + (79*c4*c7*s2*s3*s5)/250 - (79*c3*c6*s2*s5*s7)/250 - (48*c5*c6*s2*s3*s7)/125 + (48*c2*c6*s4*s5*s7)/125 - (33*c7*s2*s3*s4*s5)/400 + (33*c4*s2*s3*s6*s7)/400 + (11*c7*s2*s3*s5*s6)/125 + (79*s2*s3*s4*s6*s7)/250 - (11*c3*c4*c5*c7*s2*s6)/125 - (48*c3*c4*c6*s2*s5*s7)/125 - (79*c4*c5*c6*s2*s3*s7)/250 + (33*c3*c6*s2*s4*s5*s7)/400 + (33*c5*c6*s2*s3*s4*s7)/400;
XXnSI(1,42)=(11*c5*s2*s3)/125 - (11*c2*s4*s5)/125 - (33*c6*s2*s3)/400 + (33*c2*s5*s6)/400 + (11*c3*c4*s2*s5)/125 + (33*c4*c6*s2*s3)/400 - (33*c2*c4*s5*s6)/400 + (79*c6*s2*s3*s4)/250 + (79*c3*s2*s5*s6)/250 + (48*c5*s2*s3*s6)/125 - (48*c2*s4*s5*s6)/125 + (48*c3*c4*s2*s5*s6)/125 + (79*c4*c5*s2*s3*s6)/250 - (33*c3*s2*s4*s5*s6)/400 - (33*c5*s2*s3*s4*s6)/400;
XXnSI(2,9)=1;
XXnSI(2,13)=s3;
XXnSI(2,14)=c3;
XXnSI(2,16)=(79*c3)/250;
XXnSI(2,17)=-(79*s3)/250;
XXnSI(2,19)=c4*s3;
XXnSI(2,20)=-s3*s4;
XXnSI(2,21)=-c3;
XXnSI(2,22)=(c3*(632*c4 - 165*s4))/2000;
XXnSI(2,23)=-(c3*(165*c4 + 632*s4))/2000;
XXnSI(2,24)=(79*s3)/250;
XXnSI(2,25)=c3*s5 + c4*c5*s3;
XXnSI(2,26)=c3*c5 - c4*s3*s5;
XXnSI(2,27)=-s3*s4;
XXnSI(2,28)=(48*c3*c5)/125 - (79*s3*s5)/250 + (33*s3*s4*s5)/400 + (79*c3*c4*c5)/250 - (33*c3*c5*s4)/400 - (48*c4*s3*s5)/125;
XXnSI(2,29)=(33*c3*s4*s5)/400 - (79*c5*s3)/250 - (79*c3*c4*s5)/250 - (48*c4*c5*s3)/125 - (48*c3*s5)/125 + (33*c5*s3*s4)/400;
XXnSI(2,30)=-(c3*(165*c4 + 632*s4 - 165))/2000;
XXnSI(2,31)=c3*c6*s5 - s3*s4*s6 + c4*c5*c6*s3;
XXnSI(2,32)=- c6*s3*s4 - c3*s5*s6 - c4*c5*s3*s6;
XXnSI(2,33)=c4*s3*s5 - c3*c5;
XXnSI(2,34)=(33*c3*s6)/400 + (48*c3*c5*c6)/125 - (33*c3*c4*s6)/400 - (79*c3*s4*s6)/250 - (79*c6*s3*s5)/250 + (79*c3*c4*c5*c6)/250 - (33*c3*c5*c6*s4)/400 - (48*c4*c6*s3*s5)/125 + (33*c6*s3*s4*s5)/400;
XXnSI(2,35)=(33*c3*c6)/400 + (79*s3*s5*s6)/250 - (33*c3*c4*c6)/400 - (79*c3*c6*s4)/250 - (48*c3*c5*s6)/125 - (79*c3*c4*c5*s6)/250 + (33*c3*c5*s4*s6)/400 + (48*c4*s3*s5*s6)/125 - (33*s3*s4*s5*s6)/400;
XXnSI(2,36)=(48*c3*s5)/125 + (79*c5*s3)/250 + (79*c3*c4*s5)/250 + (48*c4*c5*s3)/125 - (33*c3*s4*s5)/400 - (33*c5*s3*s4)/400;
XXnSI(2,37)=c3*c6*c7*s5 - c3*c5*s7 + c4*s3*s5*s7 - c7*s3*s4*s6 + c4*c5*c6*c7*s3;
XXnSI(2,38)=c4*c7*s3*s5 - c3*c5*c7 - c3*c6*s5*s7 + s3*s4*s6*s7 - c4*c5*c6*s3*s7;
XXnSI(2,39)=c6*s3*s4 + c3*s5*s6 + c4*c5*s3*s6;
XXnSI(2,40)=(33*c3*c7*s6)/400 + (48*c3*s5*s7)/125 + (79*c5*s3*s7)/250 + (48*c3*c5*c6*c7)/125 - (33*c3*c4*c7*s6)/400 + (79*c3*c4*s5*s7)/250 + (48*c4*c5*s3*s7)/125 - (79*c3*c7*s4*s6)/250 - (79*c6*c7*s3*s5)/250 - (33*c3*s4*s5*s7)/400 - (33*c5*s3*s4*s7)/400 + (11*c6*s3*s4*s7)/125 + (11*c3*s5*s6*s7)/125 + (79*c3*c4*c5*c6*c7)/250 - (33*c3*c5*c6*c7*s4)/400 - (48*c4*c6*c7*s3*s5)/125 + (11*c4*c5*s3*s6*s7)/125 + (33*c6*c7*s3*s4*s5)/400;
XXnSI(2,41)=(48*c3*c7*s5)/125 + (79*c5*c7*s3)/250 - (33*c3*s6*s7)/400 + (79*c3*c4*c7*s5)/250 + (48*c4*c5*c7*s3)/125 - (48*c3*c5*c6*s7)/125 - (33*c3*c7*s4*s5)/400 - (33*c5*c7*s3*s4)/400 + (33*c3*c4*s6*s7)/400 + (11*c6*c7*s3*s4)/125 + (11*c3*c7*s5*s6)/125 + (79*c3*s4*s6*s7)/250 + (79*c6*s3*s5*s7)/250 - (79*c3*c4*c5*c6*s7)/250 + (33*c3*c5*c6*s4*s7)/400 + (11*c4*c5*c7*s3*s6)/125 + (48*c4*c6*s3*s5*s7)/125 - (33*c6*s3*s4*s5*s7)/400;
XXnSI(2,42)=(11*c3*c5)/125 - (33*c3*c6)/400 - (79*s3*s5*s6)/250 + (33*c3*c4*c6)/400 + (79*c3*c6*s4)/250 + (48*c3*c5*s6)/125 - (11*c4*s3*s5)/125 + (79*c3*c4*c5*s6)/250 - (33*c3*c5*s4*s6)/400 - (48*c4*s3*s5*s6)/125 + (33*s3*s4*s5*s6)/400;
XXnSI(3,15)=1;
XXnSI(3,19)=s4;
XXnSI(3,20)=c4;
XXnSI(3,24)=-33/400;
XXnSI(3,25)=c5*s4;
XXnSI(3,26)=-s4*s5;
XXnSI(3,27)=c4;
XXnSI(3,28)=-(3*s5*(55*c4 + 256*s4 - 55))/2000;
XXnSI(3,29)=-(3*c5*(55*c4 + 256*s4 - 55))/2000;
XXnSI(3,31)=c4*s6 + c5*c6*s4;
XXnSI(3,32)=c4*c6 - c5*s4*s6;
XXnSI(3,33)=s4*s5;
XXnSI(3,34)=-(3*c6*s5*(55*c4 + 256*s4 - 55))/2000;
XXnSI(3,35)=(3*s5*s6*(55*c4 + 256*s4 - 55))/2000;
XXnSI(3,36)=(3*c5*(55*c4 + 256*s4 - 55))/2000;
XXnSI(3,37)=s4*s5*s7 + c4*c7*s6 + c5*c6*c7*s4;
XXnSI(3,38)=c7*s4*s5 - c4*s6*s7 - c5*c6*s4*s7;
XXnSI(3,39)=c5*s4*s6 - c4*c6;
XXnSI(3,40)=(33*c4*c5*s7)/400 - (33*c5*s7)/400 - (11*c4*c6*s7)/125 + (33*c6*c7*s5)/400 + (48*c5*s4*s7)/125 - (33*c4*c6*c7*s5)/400 - (48*c6*c7*s4*s5)/125 + (11*c5*s4*s6*s7)/125;
XXnSI(3,41)=(33*c4*c5*c7)/400 - (33*c5*c7)/400 - (11*c4*c6*c7)/125 + (48*c5*c7*s4)/125 - (33*c6*s5*s7)/400 + (33*c4*c6*s5*s7)/400 + (11*c5*c7*s4*s6)/125 + (48*c6*s4*s5*s7)/125;
XXnSI(3,42)=-(s5*(176*s4 - 165*s6 + 165*c4*s6 + 768*s4*s6))/2000;
XXnSI(4,21)=1;
XXnSI(4,25)=-s5;
XXnSI(4,26)=-c5;
XXnSI(4,28)=-(48*c5)/125;
XXnSI(4,29)=(48*s5)/125;
XXnSI(4,30)=-33/400;
XXnSI(4,31)=-c6*s5;
XXnSI(4,32)=s5*s6;
XXnSI(4,33)=c5;
XXnSI(4,34)=- (33*s6)/400 - (48*c5*c6)/125;
XXnSI(4,35)=(48*c5*s6)/125 - (33*c6)/400;
XXnSI(4,36)=-(48*s5)/125;
XXnSI(4,37)=c5*s7 - c6*c7*s5;
XXnSI(4,38)=c5*c7 + c6*s5*s7;
XXnSI(4,39)=-s5*s6;
XXnSI(4,40)=- (33*c7*s6)/400 - (48*s5*s7)/125 - (11*s5*s6*s7)/125 - (48*c5*c6*c7)/125;
XXnSI(4,41)=(33*s6*s7)/400 - (48*c7*s5)/125 + (48*c5*c6*s7)/125 - (11*c7*s5*s6)/125;
XXnSI(4,42)=(33*c6)/400 - (11*c5)/125 - (48*c5*s6)/125;
XXnSI(5,27)=1;
XXnSI(5,31)=s6;
XXnSI(5,32)=c6;
XXnSI(5,37)=c7*s6;
XXnSI(5,38)=-s6*s7;
XXnSI(5,39)=-c6;
XXnSI(5,40)=-(11*c6*s7)/125;
XXnSI(5,41)=-(11*c6*c7)/125;
XXnSI(6,33)=1;
XXnSI(6,37)=s7;
XXnSI(6,38)=c7;
XXnSI(6,42)=-11/125;
XXnSI(7,39)=1;
