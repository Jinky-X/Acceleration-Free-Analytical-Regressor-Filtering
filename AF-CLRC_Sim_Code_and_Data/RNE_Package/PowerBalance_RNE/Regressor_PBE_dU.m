function Phi=Regressor_PBE_dU(sin_q,cos_q,dq)

s1=sin_q(1);s2=sin_q(2);s3=sin_q(3);s4=sin_q(4);s5=sin_q(5);s6=sin_q(6);s7=sin_q(7);
c1=cos_q(1);c2=cos_q(2);c3=cos_q(3);c4=cos_q(4);c5=cos_q(5);c6=cos_q(6);c7=cos_q(7);
dq1=dq(1);dq2=dq(2);dq3=dq(3);dq4=dq(4);dq5=dq(5);dq6=dq(6);dq7=dq(7);

%%


v_31=dq1;
v_12=-s2*v_31;
v_22=-c2*v_31;
v_32=dq2;
v_13=c3*v_12 + s3*v_32;
v_23=c3*v_32 - s3*v_12;
v_33=dq3 - v_22;
v_43=(79*c3*v_32)/250 - (79*s3*v_12)/250;
v_53=- (79*c3*v_12)/250 - (79*s3*v_32)/250;
v_14=c4*v_13 + s4*v_33;
v_24=c4*v_33 - s4*v_13;
v_34=dq4 - v_23;
v_44=c4*v_43 - (33*s4*v_23)/400;
v_54=- (33*c4*v_23)/400 - s4*v_43;
v_64=- (33*v_33)/400 - v_53;
v_15=c5*v_14 - s5*v_34;
v_25=- c5*v_34 - s5*v_14;
v_35=dq5 + v_24;
v_45=c5*v_44 - (48*c5*v_34)/125 - (48*s5*v_14)/125 - (33*s5*v_24)/400 - s5*v_64;
v_55=(48*s5*v_34)/125 - (33*c5*v_24)/400 - c5*v_64 - (48*c5*v_14)/125 - s5*v_44;
v_65=v_54 - (33*v_34)/400;
v_16=c6*v_15 + s6*v_35;
v_26=c6*v_35 - s6*v_15;
v_36=dq6 - v_25;
v_46=c6*v_45 + s6*v_65;
v_56=c6*v_65 - s6*v_45;
v_66=-v_55;
v_17=c7*v_16 + s7*v_36;
v_27=c7*v_36 - s7*v_16;
v_37=dq7 - v_26;
v_47=c7*v_46 - (11*s7*v_26)/125 + s7*v_66;
v_57=c7*v_66 - (11*c7*v_26)/125 - s7*v_46;
v_67=- (11*v_36)/125 - v_56;
Xn_0i_1_1=c1;
Xn_0i_1_2=s1;
Xn_0i_2_1=-s1;
Xn_0i_2_2=c1;
Xn_0i_4_1=-(333*s1)/1000;
Xn_0i_4_2=(333*c1)/1000;
Xn_0i_4_4=c1;
Xn_0i_4_5=s1;
Xn_0i_5_1=-(333*c1)/1000;
Xn_0i_5_2=-(333*s1)/1000;
Xn_0i_5_4=-s1;
Xn_0i_5_5=c1;
Xn_0i_7_1=Xn_0i_1_1*c2;
Xn_0i_7_2=Xn_0i_1_2*c2;
Xn_0i_7_3=-s2;
Xn_0i_8_1=-Xn_0i_1_1*s2;
Xn_0i_8_2=-Xn_0i_1_2*s2;
Xn_0i_8_3=-c2;
Xn_0i_9_1=Xn_0i_2_1;
Xn_0i_9_2=Xn_0i_2_2;
Xn_0i_10_1=Xn_0i_4_1*c2;
Xn_0i_10_2=Xn_0i_4_2*c2;
Xn_0i_10_4=Xn_0i_4_4*c2;
Xn_0i_10_5=Xn_0i_4_5*c2;
Xn_0i_10_6=-s2;
Xn_0i_11_1=-Xn_0i_4_1*s2;
Xn_0i_11_2=-Xn_0i_4_2*s2;
Xn_0i_11_4=-Xn_0i_4_4*s2;
Xn_0i_11_5=-Xn_0i_4_5*s2;
Xn_0i_11_6=-c2;
Xn_0i_12_1=Xn_0i_5_1;
Xn_0i_12_2=Xn_0i_5_2;
Xn_0i_12_4=Xn_0i_5_4;
Xn_0i_12_5=Xn_0i_5_5;
Xn_0i_13_1=Xn_0i_7_1*c3 + Xn_0i_9_1*s3;
Xn_0i_13_2=Xn_0i_7_2*c3 + Xn_0i_9_2*s3;
Xn_0i_13_3=Xn_0i_7_3*c3;
Xn_0i_14_1=Xn_0i_9_1*c3 - Xn_0i_7_1*s3;
Xn_0i_14_2=Xn_0i_9_2*c3 - Xn_0i_7_2*s3;
Xn_0i_14_3=-Xn_0i_7_3*s3;
Xn_0i_15_1=-Xn_0i_8_1;
Xn_0i_15_2=-Xn_0i_8_2;
Xn_0i_15_3=-Xn_0i_8_3;
Xn_0i_16_1=(79*Xn_0i_9_1*c3)/250 + Xn_0i_10_1*c3 - (79*Xn_0i_7_1*s3)/250 + Xn_0i_12_1*s3;
Xn_0i_16_2=(79*Xn_0i_9_2*c3)/250 + Xn_0i_10_2*c3 - (79*Xn_0i_7_2*s3)/250 + Xn_0i_12_2*s3;
Xn_0i_16_3=-(79*Xn_0i_7_3*s3)/250;
Xn_0i_16_4=Xn_0i_10_4*c3 + Xn_0i_12_4*s3;
Xn_0i_16_5=Xn_0i_10_5*c3 + Xn_0i_12_5*s3;
Xn_0i_16_6=Xn_0i_10_6*c3;
Xn_0i_17_1=Xn_0i_12_1*c3 - (79*Xn_0i_7_1*c3)/250 - (79*Xn_0i_9_1*s3)/250 - Xn_0i_10_1*s3;
Xn_0i_17_2=Xn_0i_12_2*c3 - (79*Xn_0i_7_2*c3)/250 - (79*Xn_0i_9_2*s3)/250 - Xn_0i_10_2*s3;
Xn_0i_17_3=-(79*Xn_0i_7_3*c3)/250;
Xn_0i_17_4=Xn_0i_12_4*c3 - Xn_0i_10_4*s3;
Xn_0i_17_5=Xn_0i_12_5*c3 - Xn_0i_10_5*s3;
Xn_0i_17_6=-Xn_0i_10_6*s3;
Xn_0i_18_1=-Xn_0i_11_1;
Xn_0i_18_2=-Xn_0i_11_2;
Xn_0i_18_4=-Xn_0i_11_4;
Xn_0i_18_5=-Xn_0i_11_5;
Xn_0i_18_6=-Xn_0i_11_6;
Xn_0i_19_1=Xn_0i_13_1*c4 + Xn_0i_15_1*s4;
Xn_0i_19_2=Xn_0i_13_2*c4 + Xn_0i_15_2*s4;
Xn_0i_19_3=Xn_0i_13_3*c4 + Xn_0i_15_3*s4;
Xn_0i_20_1=Xn_0i_15_1*c4 - Xn_0i_13_1*s4;
Xn_0i_20_2=Xn_0i_15_2*c4 - Xn_0i_13_2*s4;
Xn_0i_20_3=Xn_0i_15_3*c4 - Xn_0i_13_3*s4;
Xn_0i_21_1=-Xn_0i_14_1;
Xn_0i_21_2=-Xn_0i_14_2;
Xn_0i_21_3=-Xn_0i_14_3;
Xn_0i_22_1=Xn_0i_16_1*c4 - (33*Xn_0i_14_1*s4)/400 + Xn_0i_18_1*s4;
Xn_0i_22_2=Xn_0i_16_2*c4 - (33*Xn_0i_14_2*s4)/400 + Xn_0i_18_2*s4;
Xn_0i_22_3=Xn_0i_16_3*c4 - (33*Xn_0i_14_3*s4)/400;
Xn_0i_22_4=Xn_0i_16_4*c4 + Xn_0i_18_4*s4;
Xn_0i_22_5=Xn_0i_16_5*c4 + Xn_0i_18_5*s4;
Xn_0i_22_6=Xn_0i_16_6*c4 + Xn_0i_18_6*s4;
Xn_0i_23_1=Xn_0i_18_1*c4 - (33*Xn_0i_14_1*c4)/400 - Xn_0i_16_1*s4;
Xn_0i_23_2=Xn_0i_18_2*c4 - (33*Xn_0i_14_2*c4)/400 - Xn_0i_16_2*s4;
Xn_0i_23_3=- (33*Xn_0i_14_3*c4)/400 - Xn_0i_16_3*s4;
Xn_0i_23_4=Xn_0i_18_4*c4 - Xn_0i_16_4*s4;
Xn_0i_23_5=Xn_0i_18_5*c4 - Xn_0i_16_5*s4;
Xn_0i_23_6=Xn_0i_18_6*c4 - Xn_0i_16_6*s4;
Xn_0i_24_1=- (33*Xn_0i_15_1)/400 - Xn_0i_17_1;
Xn_0i_24_2=- (33*Xn_0i_15_2)/400 - Xn_0i_17_2;
Xn_0i_24_3=- (33*Xn_0i_15_3)/400 - Xn_0i_17_3;
Xn_0i_24_4=-Xn_0i_17_4;
Xn_0i_24_5=-Xn_0i_17_5;
Xn_0i_24_6=-Xn_0i_17_6;
Xn_0i_25_1=Xn_0i_19_1*c5 - Xn_0i_21_1*s5;
Xn_0i_25_2=Xn_0i_19_2*c5 - Xn_0i_21_2*s5;
Xn_0i_25_3=Xn_0i_19_3*c5 - Xn_0i_21_3*s5;
Xn_0i_26_1=- Xn_0i_21_1*c5 - Xn_0i_19_1*s5;
Xn_0i_26_2=- Xn_0i_21_2*c5 - Xn_0i_19_2*s5;
Xn_0i_26_3=- Xn_0i_21_3*c5 - Xn_0i_19_3*s5;
Xn_0i_27_1=Xn_0i_20_1;
Xn_0i_27_2=Xn_0i_20_2;
Xn_0i_27_3=Xn_0i_20_3;
Xn_0i_28_1=Xn_0i_22_1*c5 - (48*Xn_0i_21_1*c5)/125 - (48*Xn_0i_19_1*s5)/125 - (33*Xn_0i_20_1*s5)/400 - Xn_0i_24_1*s5;
Xn_0i_28_2=Xn_0i_22_2*c5 - (48*Xn_0i_21_2*c5)/125 - (48*Xn_0i_19_2*s5)/125 - (33*Xn_0i_20_2*s5)/400 - Xn_0i_24_2*s5;
Xn_0i_28_3=Xn_0i_22_3*c5 - (48*Xn_0i_21_3*c5)/125 - (48*Xn_0i_19_3*s5)/125 - (33*Xn_0i_20_3*s5)/400 - Xn_0i_24_3*s5;
Xn_0i_28_4=Xn_0i_22_4*c5 - Xn_0i_24_4*s5;
Xn_0i_28_5=Xn_0i_22_5*c5 - Xn_0i_24_5*s5;
Xn_0i_28_6=Xn_0i_22_6*c5 - Xn_0i_24_6*s5;
Xn_0i_29_1=(48*Xn_0i_21_1*s5)/125 - (33*Xn_0i_20_1*c5)/400 - Xn_0i_24_1*c5 - (48*Xn_0i_19_1*c5)/125 - Xn_0i_22_1*s5;
Xn_0i_29_2=(48*Xn_0i_21_2*s5)/125 - (33*Xn_0i_20_2*c5)/400 - Xn_0i_24_2*c5 - (48*Xn_0i_19_2*c5)/125 - Xn_0i_22_2*s5;
Xn_0i_29_3=(48*Xn_0i_21_3*s5)/125 - (33*Xn_0i_20_3*c5)/400 - Xn_0i_24_3*c5 - (48*Xn_0i_19_3*c5)/125 - Xn_0i_22_3*s5;
Xn_0i_29_4=- Xn_0i_24_4*c5 - Xn_0i_22_4*s5;
Xn_0i_29_5=- Xn_0i_24_5*c5 - Xn_0i_22_5*s5;
Xn_0i_29_6=- Xn_0i_24_6*c5 - Xn_0i_22_6*s5;
Xn_0i_30_1=Xn_0i_23_1 - (33*Xn_0i_21_1)/400;
Xn_0i_30_2=Xn_0i_23_2 - (33*Xn_0i_21_2)/400;
Xn_0i_30_3=Xn_0i_23_3 - (33*Xn_0i_21_3)/400;
Xn_0i_30_4=Xn_0i_23_4;
Xn_0i_30_5=Xn_0i_23_5;
Xn_0i_30_6=Xn_0i_23_6;
Xn_0i_31_1=Xn_0i_25_1*c6 + Xn_0i_27_1*s6;
Xn_0i_31_2=Xn_0i_25_2*c6 + Xn_0i_27_2*s6;
Xn_0i_31_3=Xn_0i_25_3*c6 + Xn_0i_27_3*s6;
Xn_0i_32_1=Xn_0i_27_1*c6 - Xn_0i_25_1*s6;
Xn_0i_32_2=Xn_0i_27_2*c6 - Xn_0i_25_2*s6;
Xn_0i_32_3=Xn_0i_27_3*c6 - Xn_0i_25_3*s6;
Xn_0i_33_1=-Xn_0i_26_1;
Xn_0i_33_2=-Xn_0i_26_2;
Xn_0i_33_3=-Xn_0i_26_3;
Xn_0i_34_1=Xn_0i_28_1*c6 + Xn_0i_30_1*s6;
Xn_0i_34_2=Xn_0i_28_2*c6 + Xn_0i_30_2*s6;
Xn_0i_34_3=Xn_0i_28_3*c6 + Xn_0i_30_3*s6;
Xn_0i_34_4=Xn_0i_28_4*c6 + Xn_0i_30_4*s6;
Xn_0i_34_5=Xn_0i_28_5*c6 + Xn_0i_30_5*s6;
Xn_0i_34_6=Xn_0i_28_6*c6 + Xn_0i_30_6*s6;
Xn_0i_35_1=Xn_0i_30_1*c6 - Xn_0i_28_1*s6;
Xn_0i_35_2=Xn_0i_30_2*c6 - Xn_0i_28_2*s6;
Xn_0i_35_3=Xn_0i_30_3*c6 - Xn_0i_28_3*s6;
Xn_0i_35_4=Xn_0i_30_4*c6 - Xn_0i_28_4*s6;
Xn_0i_35_5=Xn_0i_30_5*c6 - Xn_0i_28_5*s6;
Xn_0i_35_6=Xn_0i_30_6*c6 - Xn_0i_28_6*s6;
Xn_0i_36_1=-Xn_0i_29_1;
Xn_0i_36_2=-Xn_0i_29_2;
Xn_0i_36_3=-Xn_0i_29_3;
Xn_0i_36_4=-Xn_0i_29_4;
Xn_0i_36_5=-Xn_0i_29_5;
Xn_0i_36_6=-Xn_0i_29_6;
Xn_0i_37_1=Xn_0i_31_1*c7 + Xn_0i_33_1*s7;
Xn_0i_37_2=Xn_0i_31_2*c7 + Xn_0i_33_2*s7;
Xn_0i_37_3=Xn_0i_31_3*c7 + Xn_0i_33_3*s7;
Xn_0i_38_1=Xn_0i_33_1*c7 - Xn_0i_31_1*s7;
Xn_0i_38_2=Xn_0i_33_2*c7 - Xn_0i_31_2*s7;
Xn_0i_38_3=Xn_0i_33_3*c7 - Xn_0i_31_3*s7;
Xn_0i_39_1=-Xn_0i_32_1;
Xn_0i_39_2=-Xn_0i_32_2;
Xn_0i_39_3=-Xn_0i_32_3;
Xn_0i_40_1=Xn_0i_34_1*c7 - (11*Xn_0i_32_1*s7)/125 + Xn_0i_36_1*s7;
Xn_0i_40_2=Xn_0i_34_2*c7 - (11*Xn_0i_32_2*s7)/125 + Xn_0i_36_2*s7;
Xn_0i_40_3=Xn_0i_34_3*c7 - (11*Xn_0i_32_3*s7)/125 + Xn_0i_36_3*s7;
Xn_0i_40_4=Xn_0i_34_4*c7 + Xn_0i_36_4*s7;
Xn_0i_40_5=Xn_0i_34_5*c7 + Xn_0i_36_5*s7;
Xn_0i_40_6=Xn_0i_34_6*c7 + Xn_0i_36_6*s7;
Xn_0i_41_1=Xn_0i_36_1*c7 - (11*Xn_0i_32_1*c7)/125 - Xn_0i_34_1*s7;
Xn_0i_41_2=Xn_0i_36_2*c7 - (11*Xn_0i_32_2*c7)/125 - Xn_0i_34_2*s7;
Xn_0i_41_3=Xn_0i_36_3*c7 - (11*Xn_0i_32_3*c7)/125 - Xn_0i_34_3*s7;
Xn_0i_41_4=Xn_0i_36_4*c7 - Xn_0i_34_4*s7;
Xn_0i_41_5=Xn_0i_36_5*c7 - Xn_0i_34_5*s7;
Xn_0i_41_6=Xn_0i_36_6*c7 - Xn_0i_34_6*s7;
Xn_0i_42_1=- (11*Xn_0i_33_1)/125 - Xn_0i_35_1;
Xn_0i_42_2=- (11*Xn_0i_33_2)/125 - Xn_0i_35_2;
Xn_0i_42_3=- (11*Xn_0i_33_3)/125 - Xn_0i_35_3;
Xn_0i_42_4=-Xn_0i_35_4;
Xn_0i_42_5=-Xn_0i_35_5;
Xn_0i_42_6=-Xn_0i_35_6;

Phi=zeros(70,1);

Phi(12)=(981*Xn_0i_11_6*v_32)/100;
Phi(13)=-(981*Xn_0i_10_6*v_32)/100;
Phi(14)=(981*Xn_0i_10_6*v_22)/100 - (981*Xn_0i_11_6*v_12)/100;
Phi(21)=(981*Xn_0i_16_6*v_43)/100 + (981*Xn_0i_17_6*v_53)/100;
Phi(22)=(981*Xn_0i_17_6*v_33)/100 - (981*Xn_0i_18_6*v_23)/100;
Phi(23)=(981*Xn_0i_18_6*v_13)/100 - (981*Xn_0i_16_6*v_33)/100;
Phi(24)=(981*Xn_0i_16_6*v_23)/100 - (981*Xn_0i_17_6*v_13)/100;
Phi(31)=(981*Xn_0i_22_6*v_44)/100 + (981*Xn_0i_23_6*v_54)/100 + (981*Xn_0i_24_6*v_64)/100;
Phi(32)=(981*Xn_0i_23_6*v_34)/100 - (981*Xn_0i_24_6*v_24)/100;
Phi(33)=(981*Xn_0i_24_6*v_14)/100 - (981*Xn_0i_22_6*v_34)/100;
Phi(34)=(981*Xn_0i_22_6*v_24)/100 - (981*Xn_0i_23_6*v_14)/100;
Phi(41)=(981*Xn_0i_28_6*v_45)/100 + (981*Xn_0i_29_6*v_55)/100 + (981*Xn_0i_30_6*v_65)/100;
Phi(42)=(981*Xn_0i_29_6*v_35)/100 - (981*Xn_0i_30_6*v_25)/100;
Phi(43)=(981*Xn_0i_30_6*v_15)/100 - (981*Xn_0i_28_6*v_35)/100;
Phi(44)=(981*Xn_0i_28_6*v_25)/100 - (981*Xn_0i_29_6*v_15)/100;
Phi(51)=(981*Xn_0i_34_6*v_46)/100 + (981*Xn_0i_35_6*v_56)/100 + (981*Xn_0i_36_6*v_66)/100;
Phi(52)=(981*Xn_0i_35_6*v_36)/100 - (981*Xn_0i_36_6*v_26)/100;
Phi(53)=(981*Xn_0i_36_6*v_16)/100 - (981*Xn_0i_34_6*v_36)/100;
Phi(54)=(981*Xn_0i_34_6*v_26)/100 - (981*Xn_0i_35_6*v_16)/100;
Phi(61)=(981*Xn_0i_40_6*v_47)/100 + (981*Xn_0i_41_6*v_57)/100 + (981*Xn_0i_42_6*v_67)/100;
Phi(62)=(981*Xn_0i_41_6*v_37)/100 - (981*Xn_0i_42_6*v_27)/100;
Phi(63)=(981*Xn_0i_42_6*v_17)/100 - (981*Xn_0i_40_6*v_37)/100;
Phi(64)=(981*Xn_0i_40_6*v_27)/100 - (981*Xn_0i_41_6*v_17)/100;


