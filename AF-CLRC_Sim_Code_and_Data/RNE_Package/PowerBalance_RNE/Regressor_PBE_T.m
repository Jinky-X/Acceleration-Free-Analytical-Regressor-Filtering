function Phi=Regressor_PBE_T(sin_q,cos_q,dq)

s1=sin_q(1);s2=sin_q(2);s3=sin_q(3);s4=sin_q(4);s5=sin_q(5);s6=sin_q(6);s7=sin_q(7);
c1=cos_q(1);c2=cos_q(2);c3=cos_q(3);c4=cos_q(4);c5=cos_q(5);c6=cos_q(6);c7=cos_q(7);

dq1=dq(1);dq2=dq(2);dq3=dq(3);dq4=dq(4);dq5=dq(5);dq6=dq(6);dq7=dq(7);
v_31=dq1;
v_12=-s2*v_31;
v_22=-c2*v_31;
v_32=dq2;
v_13=c3*v_12 + s3*v_32;
v_23=c3*v_32 - s3*v_12;
v_33=dq3 - v_22;
v_43=(79*c3*v_32)/250 - (79*s3*v_12)/250;
v_53=- (79*c3*v_12)/250 - (79*s3*v_32)/250;
v_14=c4*v_13 + s4*v_33;
v_24=c4*v_33 - s4*v_13;
v_34=dq4 - v_23;
v_44=c4*v_43 - (33*s4*v_23)/400;
v_54=- (33*c4*v_23)/400 - s4*v_43;
v_64=- (33*v_33)/400 - v_53;
v_15=c5*v_14 - s5*v_34;
v_25=- c5*v_34 - s5*v_14;
v_35=dq5 + v_24;
v_45=c5*v_44 - (48*c5*v_34)/125 - (48*s5*v_14)/125 - (33*s5*v_24)/400 - s5*v_64;
v_55=(48*s5*v_34)/125 - (33*c5*v_24)/400 - c5*v_64 - (48*c5*v_14)/125 - s5*v_44;
v_65=v_54 - (33*v_34)/400;
v_16=c6*v_15 + s6*v_35;
v_26=c6*v_35 - s6*v_15;
v_36=dq6 - v_25;
v_46=c6*v_45 + s6*v_65;
v_56=c6*v_65 - s6*v_45;
v_66=-v_55;
v_17=c7*v_16 + s7*v_36;
v_27=c7*v_36 - s7*v_16;
v_37=dq7 - v_26;
v_47=c7*v_46 - (11*s7*v_26)/125 + s7*v_66;
v_57=c7*v_66 - (11*c7*v_26)/125 - s7*v_46;
v_67=- (11*v_36)/125 - v_56;

Phi=zeros(70,1);

Phi(7)=v_31^2;
Phi(15)=v_12^2;
Phi(16)=v_22^2;
Phi(17)=v_32^2;
Phi(18)=2*v_22*v_32;
Phi(19)=2*v_12*v_32;
Phi(20)=2*v_12*v_22;
Phi(21)=v_43^2 + v_53^2;
Phi(22)=2*v_33*v_53;
Phi(23)=-2*v_33*v_43;
Phi(24)=2*v_23*v_43 - 2*v_13*v_53;
Phi(25)=v_13^2;
Phi(26)=v_23^2;
Phi(27)=v_33^2;
Phi(28)=2*v_23*v_33;
Phi(29)=2*v_13*v_33;
Phi(30)=2*v_13*v_23;
Phi(31)=v_44^2 + v_54^2 + v_64^2;
Phi(32)=2*v_34*v_54 - 2*v_24*v_64;
Phi(33)=2*v_14*v_64 - 2*v_34*v_44;
Phi(34)=2*v_24*v_44 - 2*v_14*v_54;
Phi(35)=v_14^2;
Phi(36)=v_24^2;
Phi(37)=v_34^2;
Phi(38)=2*v_24*v_34;
Phi(39)=2*v_14*v_34;
Phi(40)=2*v_14*v_24;
Phi(41)=v_45^2 + v_55^2 + v_65^2;
Phi(42)=2*v_35*v_55 - 2*v_25*v_65;
Phi(43)=2*v_15*v_65 - 2*v_35*v_45;
Phi(44)=2*v_25*v_45 - 2*v_15*v_55;
Phi(45)=v_15^2;
Phi(46)=v_25^2;
Phi(47)=v_35^2;
Phi(48)=2*v_25*v_35;
Phi(49)=2*v_15*v_35;
Phi(50)=2*v_15*v_25;
Phi(51)=v_46^2 + v_56^2 + v_66^2;
Phi(52)=2*v_36*v_56 - 2*v_26*v_66;
Phi(53)=2*v_16*v_66 - 2*v_36*v_46;
Phi(54)=2*v_26*v_46 - 2*v_16*v_56;
Phi(55)=v_16^2;
Phi(56)=v_26^2;
Phi(57)=v_36^2;
Phi(58)=2*v_26*v_36;
Phi(59)=2*v_16*v_36;
Phi(60)=2*v_16*v_26;
Phi(61)=v_47^2 + v_57^2 + v_67^2;
Phi(62)=2*v_37*v_57 - 2*v_27*v_67;
Phi(63)=2*v_17*v_67 - 2*v_37*v_47;
Phi(64)=2*v_27*v_47 - 2*v_17*v_57;
Phi(65)=v_17^2;
Phi(66)=v_27^2;
Phi(67)=v_37^2;
Phi(68)=2*v_27*v_37;
Phi(69)=2*v_17*v_37;
Phi(70)=2*v_17*v_27;

Phi=Phi/2;
